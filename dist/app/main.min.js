!function(){"user strict";angular.module("collectionApp",["ui.router","ngMaterial","ngFileUpload"]),angular.module("collectionApp").constant("config",{uploadpath:"uploads/",api:"../backend/"})}(),function(){"user strict";angular.module("collectionApp").config(function(t,o,e){o.otherwise("/home"),t.state("home",{url:"/home",controller:"homeCtrl",templateUrl:"views/home.html"}).state("newcollection",{url:"/newcollection",controller:"newCollectionCtrl",templateUrl:"views/newcollection.html"}).state("addcategory",{url:"/addcategory",controller:"addCategoryCtrl",templateUrl:"views/addcategory.html"}).state("additem",{url:"/additem",controller:"addItemCtrl",templateUrl:"views/additem.html"}).state("viewitem",{url:"/viewitem/:itemid",controller:"itemCtrl",templateUrl:"views/viewitem.html"}).state("browse",{url:"/browse/:collection_id",controller:"browseCtrl",templateUrl:"views/browsecollection.html"}),e.interceptors.push("LoadingInterceptor")})}(),function(){"use strict";function t(t,o,e,n){function i(){o.updateList("category").then(function(o){t.categoryList=o.data})["catch"](function(t){alert("Error:",t.status,t.data)}),o.updateList("collection").then(function(o){t.collectionList=o.data})["catch"](function(t){alert("Error:",t.status,t.data)})}function c(){o.updateList("category").then(function(o){t.categoryList=o.data})["catch"](function(t){alert("Error:",t.status,t.data)})}t.categoryList=[],t.collectionList=[],t.currCollection={},t.toastPosition={bottom:!0,top:!1,left:!1,right:!0},i(),t.getToastPosition=function(){return Object.keys(t.toastPosition).filter(function(o){return t.toastPosition[o]}).join(" ")},t.setCollection=function(o){var e=JSON.parse(o);t.currCollection=e},t.submitForm=function(n){n.collection=t.currCollection.collection_id,t.categoryForm.$valid&&o.addCategory(n).then(function(o){e.show(e.simple().content("Category "+n.name+" added !").position(t.getToastPosition()).hideDelay(3e3)),t.categoryForm.$setPristine(),t.category=null,c()})["catch"](function(t){alert("Error:",t.status,t.data)})}}angular.module("collectionApp").controller("addCategoryCtrl",t),t.$inject=["$scope","ioService","$mdToast","$animate"]}(),function(){"use strict";function t(t,o,e,n,i,c){function l(){o.updateList("category").then(function(o){t.categoryList=o.data})["catch"](function(t){alert("Error:",t.status,t.data)}),o.updateList("collection").then(function(o){t.collectionList=o.data})["catch"](function(t){alert("Error:",t.status,t.data)})}t.categoryList=[],t.collectionList=[],t.currCollection={};var a=document.getElementById("fileInput"),r=document.getElementById("uploadButton");r.addEventListener("click",function(){a.click()}),t.toastPosition={bottom:!1,top:!0,left:!1,right:!0},l(),t.setCollection=function(o){var e=JSON.parse(o);t.currCollection=e},t.getToastPosition=function(){return Object.keys(t.toastPosition).filter(function(o){return t.toastPosition[o]}).join(" ")},t.submitForm=function(o){var n=t.currCollection.collection_name,c=t.currCollection.collection_id;console.log("collname:"+n+" id:"+c),t.itemForm.$valid&&e.upload({url:"backend/include.php?type=item",method:"POST",data:{file:t.item.picture,otherinfo:o,collName:n,collId:c}}).then(function(e){i.show(i.simple().content("Item "+o.name+" added !").position(t.getToastPosition()).hideDelay(3e3)),t.itemForm.$setPristine(),t.item=null,console.log("Success "+e.config.data.file.name+"uploaded. Response: "+e.data)},function(t){console.log("Error status: "+t.status)},function(t){var o=parseInt(100*t.loaded/t.total);console.log("progress: "+o+"% "+t.config.data.file.name)})}}angular.module("collectionApp").controller("addItemCtrl",t),t.$inject=["$scope","ioService","Upload","$timeout","$mdToast","$animate"]}(),function(){"use strict";function t(t,o){t.toggleLeft=function(){o("leftMenu").toggle()}}angular.module("collectionApp").controller("appCtrl",t),t.$inject=["$scope","$mdSidenav"]}(),function(){"use strict";function t(t,o,e,n){function i(){o.updateList("category").then(function(o){t.categoryList=o.data})["catch"](function(t){alert("Error:",t.status,t.data)}),o.updateList("collection",!1).then(function(o){t.collectionList=o.data})["catch"](function(t){alert("Error:",t.status,t.data)})}function c(e,n){console.log("getting items"),o.updateList("item",e,n).then(function(o){t.itemList=o.data})["catch"](function(t){alert("Error:",t.status,t.data)})}if(t.categoryList=[],t.collectionList=[],t.itemList=[],t.currentCategory={},t.currCollection={},t.uploadpath=e.uploadpath,n.collection_id){var l=n.collection_id;o.updateList("collection",l).then(function(o){console.log("coll do if:"+o.data),t.currCollection=o.data[0],t.collection=t.currCollection,c(!1,l)})["catch"](function(t){alert("Error:",t.status,t.data)})}i(),t.setCollection=function(o){var e=JSON.parse(o);console.log("coll do set:"+e),t.currCollection=e,c(!1,t.currCollection.collection_id)},t.setCategory=function(o){var e=JSON.parse(o);t.currentCategory=e}}angular.module("collectionApp").controller("browseCtrl",t),t.$inject=["$scope","ioService","config","$stateParams"]}(),function(){"use strict";function t(t,o,e){function n(){o.updateList("collection").then(function(o){t.collectionList=o.data})["catch"](function(t){alert("Error:",t.status,t.data)}),o.updateList("dash").then(function(o){t.dash=o.data})["catch"](function(t){alert("Error:",t.status,t.data)})}t.collectionList=[],t.dash={},n()}angular.module("collectionApp").controller("homeCtrl",t),t.$inject=["$scope","ioService","$mdSidenav"]}(),function(){"use strict";function t(t,o,e,n){function i(){o.updateList("collection").then(function(o){t.collectionList=o.data})["catch"](function(t){alert("Error:",t.status,t.data)})}t.collectionList=[],i(),t.toastPosition={bottom:!1,top:!0,left:!1,right:!0},t.getToastPosition=function(){return Object.keys(t.toastPosition).filter(function(o){return t.toastPosition[o]}).join(" ")},t.submitForm=function(n){t.collectionForm.$valid&&o.addCollection(n).then(function(o){e.show(e.simple().content("Collection "+n.name+" added !").position(t.getToastPosition()).hideDelay(3e3)),t.collectionForm.$setPristine(),t.collection="",i()})["catch"](function(t){alert("Error:",t.status,t.data)})}}angular.module("collectionApp").controller("newCollectionCtrl",t),t.$inject=["$scope","ioService","$mdToast","$animate"]}(),function(){"use strict";function t(t,o,e,n,i){function c(e){o.updateList("item",e).then(function(o){t.item=o.data,l(t.item[0].collection_id)})["catch"](function(t){alert("Error:",t.status,t.data)})}function l(e){o.updateList("collection",e).then(function(o){t.collection=o.data,t.item[0].collection_name=t.collection[0].collection_name,a(t.item[0].category_id)})["catch"](function(t){alert("Error:",t.status,t.data)})}function a(e){o.updateList("category",e).then(function(o){t.category=o.data,t.item[0].category_name=t.category[0].category_name})["catch"](function(t){alert("Error:",t.status,t.data)})}console.log("Params: "+n.itemid),t.category=[],t.collection=[],t.item=[],t.uploadpath=e.uploadpath,c(n.itemid)}angular.module("collectionApp").controller("itemCtrl",t),t.$inject=["$scope","ioService","config","$stateParams","$q"]}(),function(){"use strict";angular.module("collectionApp").directive("dashboard",function(){return{restrict:"E",scope:{dash:"=",collectionList:"="},templateUrl:"views/templates/dashboard.html"}})}(),function(){"use strict";angular.module("collectionApp").factory("ioService",function(t,o){var e={};return e.addCollection=function(e){return t.post(o.api+"include.php?type=col",e)},e.addCategory=function(o){return console.log(o),t.post("backend/include.php?type=cat",o)},e.updateList=function(e,n,i){switch(e){case"collection":return n?(console.log("return collection :"+n),t.get(o.api+"updatelist.php?type=col&id="+n)):t.get(o.api+"updatelist.php?type=col");case"category":return n?t.get(o.api+"updatelist.php?type=cat&id="+n):t.get(o.api+"updatelist.php?type=cat");case"item":return n?(console.log("return Item :"+n),t.get(o.api+"updatelist.php?type=item&id="+n)):i?(console.log("return all Items from coll:"+i),t.get(o.api+"updatelist.php?type=item&coll="+i)):(console.log("return all Items in all collections"),t.get(o.api+"updatelist.php?type=item"));case"dash":return t.get(o.api+"updatelist.php?type=dash")}},e})}(),function(){"use strict";angular.module("collectionApp").service("LoadingInterceptor",["$q","$rootScope","$log",function(t,o,e){function n(){return c>l}function i(){o.loading=n()}var c=0,l=0;return{request:function(t){return c++,i(),t},requestError:function(o){return l++,i(),e.error("Request error:",o),t.reject(o)},response:function(t){return l++,i(),t},responseError:function(o){return l++,i(),e.error("Response error:",o),t.reject(o)}}}])}();